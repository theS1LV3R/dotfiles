#zmodload zsh/zprof

zmodload zsh/complist
autoload compinit && compinit
autoload -U bashcompinit && bashcompinit


export DOTFILES_DIR={{ .chezmoi.sourceDir }}
export SCRIPTS_DIR="$HOME/.config/zsh"
export GPG_TTY=$(tty)

# Zi options
declare -A ZI

ZI[HOME_DIR]="${DOTFILES_DIR}/zi"
ZI[BIN_DIR]="${ZI[HOME_DIR]}/bin"

export zi_home="${DOTFILES_DIR}/zi"
source "${zi_home}/bin/zi.zsh"


#! SOURCE **BEFORE** ANTIGEN
#! IMPORTANT
source $SCRIPTS_DIR/zsh-autocomplete.zsh


export fpath=($SCRIPTS_DIR/completions $fpath)

# p10k (Prompt)
source $SCRIPTS_DIR/p10k.init.zsh

# Everything else zsh related
source $SCRIPTS_DIR/zsh.init.zsh

# P10K theme
zi ice if"[ "${TERM##*-}" = '256color' ] || [ "${terminfo[colors]:?}" -gt 255 ]" depth=1
zi light romkatv/powerlevel10k

# Various other stuff
zi load zsh-users/zsh-syntax-highlighting
zi load zsh-users/zsh-autosuggestions
zi load zsh-users/zsh-completions

omz_plugins=(
    pip
    aws
    command-not-found
    docker
    docker-compose
    node
    gitignore
    git
    aliases
    archlinux
)

for plugin in "${omz_plugins[@]}"; do
    zi snippet OMZP::${plugin}
done

zi light-mode for \
  z-shell/z-a-meta-plugins \
  @annexes
zicompinit
